INFO | 2025-11-26 18:23:17 | WorkDirectory(root=PosixPath('/home/yms/flow_matching/examples/text/Hydra/2025.11.26/182303'), checkpoint=PosixPath('/home/yms/flow_matching/examples/text/Hydra/2025.11.26/182303/checkpoints/checkpoint.pth'), samples=PosixPath('/home/yms/flow_matching/examples/text/Hydra/2025.11.26/182303/samples'))
INFO | 2025-11-26 18:23:17 | {'compute': {'ngpus': 8, 'nodes': 1}, 'logging': {'log_freq': 100, 'log_lr_every': '${logging.log_freq}', 'log_file_name': 'stdout.log', 'enable_wandb': True, 'entity': None, 'project': 'flow_matching', 'group': None}, 'data': {'train': 'wikitext103', 'valid': 'wikitext103', 'cache_dir': '/home/yms/flow_matching/examples/text/cache', 'num_workers': 8}, 'training': {'batch_size': 64, 'snapshot': 2000, 'eval_freq': 20000, 'perplexity_freq': 20000, 'seed': 42}, 'eval': {'batch_size': 16, 'sample_batch_size': 8, 'perplexity': True, 'perplexity_batch_size': 8}, 'optim': {'weight_decay': 0.03, 'optimizer': 'AdamW', 'lr': 0.0003, 'beta1': 0.9, 'beta2': 0.95, 'eps': 1e-08, 'warmup': 2500, 'grad_clip': 1.0, 'eta_min_ratio': 0.1, 'fused': False, 'n_iters': 1000000, 'log_lr_every': '${logging.log_lr_every}'}, 'flow': {'source_distribution': 'uniform', 'loss_function': 'cross_entropy', 'exponent': 1.0, 'scheduler_type': 'polynomial', 'sampling_steps': 1024}, 'model': {'hidden_size': 768, 'cond_dim': 128, 'length': 1024, 'n_blocks': 12, 'n_heads': 12, 'dropout': 0.1, 'compile': True}, 'hydra_dir': '/home/yms/flow_matching/examples/text/Hydra', 'work_dir': '/home/yms/flow_matching/examples/text/Hydra/2025.11.26/182303'}
INFO | 2025-11-26 18:23:17 | Found 8 CUDA devices.
INFO | 2025-11-26 18:23:17 | NVIDIA GeForce RTX 3090 	 Memory: 23.56GB
INFO | 2025-11-26 18:23:17 | NVIDIA GeForce RTX 3090 	 Memory: 23.56GB
INFO | 2025-11-26 18:23:17 | NVIDIA GeForce RTX 3090 	 Memory: 23.56GB
INFO | 2025-11-26 18:23:17 | NVIDIA GeForce RTX 3090 	 Memory: 23.56GB
INFO | 2025-11-26 18:23:17 | NVIDIA GeForce RTX 3090 	 Memory: 23.56GB
INFO | 2025-11-26 18:23:17 | NVIDIA GeForce RTX 3090 	 Memory: 23.56GB
INFO | 2025-11-26 18:23:17 | NVIDIA GeForce RTX 3090 	 Memory: 23.56GB
INFO | 2025-11-26 18:23:17 | NVIDIA GeForce RTX 3090 	 Memory: 23.56GB
INFO | 2025-11-26 18:23:17 | Found 40 total number of CPUs.
INFO | 2025-11-26 18:23:20 | Number of parameters in the model: 169625681
INFO | 2025-11-26 18:23:21 | DistributedDataParallel(
  (module): Transformer(
    (vocab_embed): Embedding(50257, 768)
    (time_embedding): TimestepEmbedder(
      (mlp): Sequential(
        (0): Linear(in_features=256, out_features=128, bias=True)
        (1): SiLU()
        (2): Linear(in_features=128, out_features=128, bias=True)
      )
    )
    (rotary_emb): Rotary()
    (blocks): ModuleList(
      (0-11): 12 x DDiTBlock(
        (norm1): LayerNorm()
        (qw): Linear(in_features=768, out_features=768, bias=False)
        (kw): Linear(in_features=768, out_features=768, bias=False)
        (vw): Linear(in_features=768, out_features=768, bias=False)
        (attn_out): Linear(in_features=768, out_features=768, bias=False)
        (dropout1): Dropout(p=0.1, inplace=False)
        (norm2): LayerNorm()
        (mlp): Sequential(
          (0): Linear(in_features=768, out_features=3072, bias=True)
          (1): GELU(approximate='tanh')
          (2): Linear(in_features=3072, out_features=768, bias=True)
        )
        (adaLN_modulation): Linear(in_features=128, out_features=4608, bias=True)
      )
    )
    (output_layer): DDitFinalLayer(
      (norm_final): LayerNorm()
      (linear): Linear(in_features=768, out_features=50257, bias=True)
      (adaLN_modulation): Linear(in_features=128, out_features=1536, bias=True)
    )
  )
)
INFO | 2025-11-26 18:23:21 | Optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.95)
    capturable: False
    decoupled_weight_decay: True
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: False
    lr: 0.0003
    maximize: False
    weight_decay: 0.03
)
INFO | 2025-11-26 18:23:21 | Scaler: <torch.amp.grad_scaler.GradScaler object at 0x7f7ed0217dc0>
Map (num_proc=8): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1801350/1801350 [02:26<00:00, 12335.04 examples/s]
Map (num_proc=8): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1801350/1801350 [00:26<00:00, 68342.72 examples/s]
WARNING | 2025-11-26 18:26:29 | No checkpoint found at /home/yms/flow_matching/examples/text/Hydra/2025.11.26/182303/checkpoints/checkpoint.pth. Returned the same state as input
INFO | 2025-11-26 18:26:32 | Starting training loop at step 1.
[rank0]:W1126 18:26:49.714000 79917 site-packages/torch/_logging/_internal.py:1199] [0/0] Profiler function <class 'torch.autograd.profiler.record_function'> will be ignored
INFO | 2025-11-26 18:30:19 | [100] Train Loss: 10.750
